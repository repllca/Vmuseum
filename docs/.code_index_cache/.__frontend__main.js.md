## ./frontend/main.js

### 先頭コメント（あれば）
- // ===============================
- //  Main VR Museum Frontend
- //  （P=閲覧モード / Raycastで選択→拡大表示 / works数に応じて可変）
- //  + ChatLogはUser/AIのみ（systemはtoast）
- //  + 4面配置（front/back/left/right）
- //  + test.csv をフロントで読み込み（F番号→title/width/height/imagefilename）
- //  + 作品ごとにサイズ可変（実寸m→スケール変換）
- // ===============================
- // ============================================================
- // シーン初期化
- // ============================================================
- // ============================================================
- // UI（ChatLogはUser/AIのみ、状態はtoast）
- // ============================================================
- // ============================================================

### 主要シンボル（export/def/class/type など）
- async function initCatalog() {
- function resolveImageUrlFromMeta(meta) {
-   if (meta?.wikimediaurl && meta.wikimediaurl.includes("upload.wikimedia.org")) {
- function enrichWorksWithCatalog(works) {
- function setViewMode(on) {
-   if (viewMode && document.pointerLockElement) {
- function updateMouseNDCFromEvent(e) {
- function getArtworkMeshes() {
- function setHover(mesh) {
-   if (lastHover && lastHover.material && lastHoverColor) {
-   if (!lastHover || !lastHover.material || !lastHover.material.color) {
-   if (!url) {
- function normalizePayload(data) {
-   if (typeof data.text === "string") {
-     if (s.startsWith("{") && s.endsWith("}")) {
- function normalizeWorks(payload) {
- function buildWallConfigs() {
- function layoutPositionsOnFourWalls(
-   for (let w = 0; w < walls.length; w++) {
-     for (let k = 0; k < indices.length; k++) {
-       const xOffset = (col - (cols - 1) / 2) * cellW;
- function sizeFromWork(work) {
- function syncFramesToWorks(works) {
-   while (frames.length > n) {
-   for (let i = 0; i < n; i++) {
-     if (payload?.curator_comment) {
-     if (worksRaw.length === 0) {
- function handlePlayerMovement() {
-   if (hud.isTyping() || viewMode || viewer.isOpen()) {
-   if (move.lengthSq() > 0) {
- function animate() {

### import/依存（上位だけ）
- import * as THREE from "https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.module.js";
- import { setupControls } from "./controls.js";
- import { setupMultiplayer } from "./multiplayer.js";
- import { createArtFrame } from "./exhibits/artFrame.js";
- import { setupHudInput } from "./ui/hubInput.js";
- import { createChatLog } from "./ui/chatLog.js";
- import { createImageViewer } from "./ui/imageViewer.js";
- import { createToast } from "./ui/toast.js";
- import { loadCatalogCsv } from "./ui/catalogCsv.js";
- import { createScene, ROOM } from "./scene.js";
- import { setupPhysics } from "./physics.js";

### 役割（ここを最終的に CODE_INDEX に反映）
- (TBD) このファイルの責務を1行で書く

